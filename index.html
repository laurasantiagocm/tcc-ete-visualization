<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>TCC - Visualização dos Dados</title>

    <!-- Custom fonts for this template-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dc/4.2.7/style/dc.css"
        integrity="sha512-ZCK4qcVpG4m3G6VG2CWs5Tl870Xn9xhT3SWJLmbsbTfU9/hzyZDeCzyLpjsCc27YxlDi19URyKlY+h4cQIifig=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="css/sb-admin-2.min.css" rel="stylesheet">

</head>

<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <!-- End of Topbar -->

                <!-- Begin Page Content -->
                <div class="container-fluid">

                    <!-- Page Heading -->
                    <div class="d-sm-flex align-items-center justify-content-center mb-4 mt-4">
                        <h1 class="h3 mb-0 text-gray-800">Visualização de Dados - Estações de Tratamento</h1>
                    </div>

                    <!-- Content Row -->
                    <div class="row">

                        <!-- Earnings (Monthly) Card Example -->
                        <div class="col-xl-3 col-md-6 mb-4">
                            <div class="card border-left-primary shadow h-100 py-2">
                                <div class="card-body">
                                    <div class="row no-gutters align-items-center">
                                        <div class="col mr-2">
                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                ETEs</div>
                                            <div class="h5 mb-0 font-weight-bold text-gray-800" id="ete-amount">66</div>
                                        </div>
                                        <div class="col-auto">
                                            <i class="fas fa-calendar fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Earnings (Monthly) Card Example -->
                        <div class="col-xl-3 col-md-6 mb-4">
                            <div class="card border-left-success shadow h-100 py-2">
                                <div class="card-body">
                                    <div class="row no-gutters align-items-center">
                                        <div class="col mr-2">
                                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                                Earnings (Annual)</div>
                                            <div class="h5 mb-0 font-weight-bold text-gray-800">$215,000</div>
                                        </div>
                                        <div class="col-auto">
                                            <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Earnings (Monthly) Card Example -->
                        <div class="col-xl-3 col-md-6 mb-4">
                            <div class="card border-left-info shadow h-100 py-2">
                                <div class="card-body">
                                    <div class="row no-gutters align-items-center">
                                        <div class="col mr-2">
                                            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Tasks
                                            </div>
                                            <div class="row no-gutters align-items-center">
                                                <div class="col-auto">
                                                    <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">50%</div>
                                                </div>
                                                <div class="col">
                                                    <div class="progress progress-sm mr-2">
                                                        <div class="progress-bar bg-info" role="progressbar"
                                                            style="width: 50%" aria-valuenow="50" aria-valuemin="0"
                                                            aria-valuemax="100"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-auto">
                                            <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Pending Requests Card Example -->
                        <div class="col-xl-3 col-md-6 mb-4">
                            <div class="card border-left-warning shadow h-100 py-2">
                                <div class="card-body">
                                    <div class="row no-gutters align-items-center">
                                        <div class="col mr-2">
                                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                                Pending Requests</div>
                                            <div class="h5 mb-0 font-weight-bold text-gray-800">18</div>
                                        </div>
                                        <div class="col-auto">
                                            <i class="fas fa-comments fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Content Row -->
                    <div class="row">
                        <div id="main-div" style="display: flex; flex-direction: row; width: 100%">
                            <div id="ete-quantity-only">
                                <div class="col-md-12">
                                    <div class="card shadow mb-4">
                                        <!-- Card Header - Dropdown -->
                                        <div
                                            class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                            <h6 class="m-0 font-weight-bold text-primary">Quantidade de ETEs</h6>
                                            <div class="dropdown no-arrow">
                                                <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                                                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                    <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                                </a>
                                                <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                                    aria-labelledby="dropdownMenuLink">
                                                    <div class="dropdown-header">Dropdown Header:</div>
                                                    <a class="dropdown-item" href="#">Action</a>
                                                    <a class="dropdown-item" href="#">Another action</a>
                                                    <div class="dropdown-divider"></div>
                                                    <a class="dropdown-item" href="#">Something else here</a>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Card Body -->
                                        <div class="card-body" style="height: 2100px;">
                                            <div class="chart-area">
                                                <div id="ete-sum"></div>
                                                <input type="file" id="csvFile" accept=".csv">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="remaining-graphs">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card shadow mb-4">
                                            <!-- Card Header - Dropdown -->
                                            <div
                                                class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                                <h6 class="m-0 font-weight-bold text-primary">PCA</h6>
                                                <div class="dropdown no-arrow">
                                                    <a class="dropdown-toggle" href="#" role="button"
                                                        id="dropdownMenuLink" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false">
                                                        <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                                    </a>
                                                    <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                                        aria-labelledby="dropdownMenuLink">
                                                        <div class="dropdown-header">Dropdown Header:</div>
                                                        <a class="dropdown-item" href="#">Action</a>
                                                        <a class="dropdown-item" href="#">Another action</a>
                                                        <div class="dropdown-divider"></div>
                                                        <a class="dropdown-item" href="#">Something else here</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Card Body -->
                                            <div class="card-body" style="height: 650px;">
                                                <div class="chart-pie pb-2">
                                                    <div id="pca-12"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card shadow mb-4">
                                            <!-- Card Header - Dropdown -->
                                            <div
                                                class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                                <h6 class="m-0 font-weight-bold text-primary">t-SNE</h6>
                                                <div class="dropdown no-arrow">
                                                    <a class="dropdown-toggle" href="#" role="button"
                                                        id="dropdownMenuLink" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false">
                                                        <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                                    </a>
                                                    <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                                        aria-labelledby="dropdownMenuLink">
                                                        <div class="dropdown-header">Dropdown Header:</div>
                                                        <a class="dropdown-item" href="#">Action</a>
                                                        <a class="dropdown-item" href="#">Another action</a>
                                                        <div class="dropdown-divider"></div>
                                                        <a class="dropdown-item" href="#">Something else here</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Card Body -->
                                            <div class="card-body" style="height: 650px;">
                                                <div class="chart-pie pb-2">
                                                    <div id="tsne-12"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- metas % etes -->
                                </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="card shadow mb-4">
                                            <!-- Card Header - Dropdown -->
                                            <div
                                                class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                                <h6 class="m-0 font-weight-bold text-primary">% de ETEs que atingiram as
                                                    metas</h6>
                                                <div class="dropdown no-arrow">
                                                    <a class="dropdown-toggle" href="#" role="button"
                                                        id="dropdownMenuLink" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false">
                                                        <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                                    </a>
                                                    <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                                        aria-labelledby="dropdownMenuLink">
                                                        <div class="dropdown-header">Dropdown Header:</div>
                                                        <a class="dropdown-item" href="#">Action</a>
                                                        <a class="dropdown-item" href="#">Another action</a>
                                                        <div class="dropdown-divider"></div>
                                                        <a class="dropdown-item" href="#">Something else here</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Card Body -->
                                            <div class="card-body">
                                                <div class="chart-pie pb-2">
                                                    <div id="meta-chart"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-9">
                                        <div class="card shadow mb-4">
                                            <!-- Card Header - Dropdown -->
                                            <div
                                                class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                                <h6 class="m-0 font-weight-bold text-primary">Quantidade por Tecnologia
                                                </h6>
                                                <div class="dropdown no-arrow">
                                                    <a class="dropdown-toggle" href="#" role="button"
                                                        id="dropdownMenuLink" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false">
                                                        <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                                    </a>
                                                    <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                                        aria-labelledby="dropdownMenuLink">
                                                        <div class="dropdown-header">Dropdown Header:</div>
                                                        <a class="dropdown-item" href="#">Action</a>
                                                        <a class="dropdown-item" href="#">Another action</a>
                                                        <div class="dropdown-divider"></div>
                                                        <a class="dropdown-item" href="#">Something else here</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Card Body -->
                                            <div class="card-body">
                                                <div class="chart-pie pb-2">
                                                    <div id="tipo-sum"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="card shadow mb-4">
                                            <!-- Card Header - Dropdown -->
                                            <div
                                                class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                                <h6 class="m-0 font-weight-bold text-primary">Distribuição</h6>
                                                <div class="dropdown no-arrow">
                                                    <a class="dropdown-toggle" href="#" role="button"
                                                        id="dropdownMenuLink" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false">
                                                        <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                                    </a>
                                                    <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                                        aria-labelledby="dropdownMenuLink">
                                                        <div class="dropdown-header">Dropdown Header:</div>
                                                        <a class="dropdown-item" href="#">Action</a>
                                                        <a class="dropdown-item" href="#">Another action</a>
                                                        <div class="dropdown-divider"></div>
                                                        <a class="dropdown-item" href="#">Something else here</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Card Body -->
                                            <div class="card-body" style="height: 550px;">
                                                <div class="chart-pie pb-2">
                                                    DQO
                                                    <div id="dqo-hist"></div>
                                                    SST
                                                    <div id="sst-hist"></div>
                                                    EColi
                                                    <div id="ecoli-hist"></div>
                                                    pH
                                                    <div id="ph-hist"></div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3">
                                <h6 class="m-0 font-weight-bold text-primary">DataTables Example</h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table id="dc-table-graph" class="table table-bordered"></table>
                                </div>
                            </div>
                        </div>

                    </div>


                    <!-- Content Row -->
                    <div class="row">

                        <!-- Content Column -->
                        <div class="col-lg-6 mb-4">

                            <!-- Project Card Example -->
                            <!-- <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="m-0 font-weight-bold text-primary">Projects</h6>
                                </div>
                                <div class="card-body">
                                    <h4 class="small font-weight-bold">Server Migration <span
                                            class="float-right">20%</span></h4>
                                    <div class="progress mb-4">
                                        <div class="progress-bar bg-danger" role="progressbar" style="width: 20%"
                                            aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <h4 class="small font-weight-bold">Sales Tracking <span
                                            class="float-right">40%</span></h4>
                                    <div class="progress mb-4">
                                        <div class="progress-bar bg-warning" role="progressbar" style="width: 40%"
                                            aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <h4 class="small font-weight-bold">Customer Database <span
                                            class="float-right">60%</span></h4>
                                    <div class="progress mb-4">
                                        <div class="progress-bar" role="progressbar" style="width: 60%"
                                            aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <h4 class="small font-weight-bold">Payout Details <span
                                            class="float-right">80%</span></h4>
                                    <div class="progress mb-4">
                                        <div class="progress-bar bg-info" role="progressbar" style="width: 80%"
                                            aria-valuenow="80" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <h4 class="small font-weight-bold">Account Setup <span
                                            class="float-right">Complete!</span></h4>
                                    <div class="progress">
                                        <div class="progress-bar bg-success" role="progressbar" style="width: 100%"
                                            aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div> -->

                            <!-- Color System -->
                            <div class="row">
                                <div class="col-lg-6 mb-4">
                                    <div class="card bg-primary text-white shadow">
                                        <div class="card-body">
                                            Primary
                                            <div class="text-white-50 small">#4e73df</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 mb-4">
                                    <div class="card bg-success text-white shadow">
                                        <div class="card-body">
                                            Success
                                            <div class="text-white-50 small">#1cc88a</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 mb-4">
                                    <div class="card bg-info text-white shadow">
                                        <div class="card-body">
                                            Info
                                            <div class="text-white-50 small">#36b9cc</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 mb-4">
                                    <div class="card bg-warning text-white shadow">
                                        <div class="card-body">
                                            Warning
                                            <div class="text-white-50 small">#f6c23e</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 mb-4">
                                    <div class="card bg-danger text-white shadow">
                                        <div class="card-body">
                                            Danger
                                            <div class="text-white-50 small">#e74a3b</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 mb-4">
                                    <div class="card bg-secondary text-white shadow">
                                        <div class="card-body">
                                            Secondary
                                            <div class="text-white-50 small">#858796</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 mb-4">
                                    <div class="card bg-light text-black shadow">
                                        <div class="card-body">
                                            Light
                                            <div class="text-black-50 small">#f8f9fc</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 mb-4">
                                    <div class="card bg-dark text-white shadow">
                                        <div class="card-body">
                                            Dark
                                            <div class="text-white-50 small">#5a5c69</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="col-lg-6 mb-4">

                            <!-- Illustrations -->
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="m-0 font-weight-bold text-primary">Illustrations</h6>
                                </div>
                                <div class="card-body">
                                    <div class="text-center">
                                        <img class="img-fluid px-3 px-sm-4 mt-3 mb-4" style="width: 25rem;"
                                            src="img/undraw_posting_photo.svg" alt="...">
                                    </div>
                                    <p>Add some quality, svg illustrations to your project courtesy of <a
                                            target="_blank" rel="nofollow" href="https://undraw.co/">unDraw</a>, a
                                        constantly updated collection of beautiful svg images that you can use
                                        completely free and without attribution!</p>
                                    <a target="_blank" rel="nofollow" href="https://undraw.co/">Browse Illustrations on
                                        unDraw &rarr;</a>
                                </div>
                            </div>

                            <!-- Approach -->
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="m-0 font-weight-bold text-primary">Development Approach</h6>
                                </div>
                                <div class="card-body">
                                    <p>SB Admin 2 makes extensive use of Bootstrap 4 utility classes in order to reduce
                                        CSS bloat and poor page performance. Custom CSS classes are used to create
                                        custom components and custom utility classes.</p>
                                    <p class="mb-0">Before working with this theme, you should become familiar with the
                                        Bootstrap framework, especially the utility classes.</p>
                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <!-- /.container-fluid -->

            </div>
            <!-- End of Main Content -->

            <!-- Footer -->
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; Your Website 2021</span>
                    </div>
                </div>
            </footer>
            <!-- End of Footer -->

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- Logout Modal-->
    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                    <a class="btn btn-primary" href="login.html">Logout</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap core JavaScript-->
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter2/1.5.4/crossfilter.js"
        integrity="sha512-9LbNNlYA/tM4I3VSQFfCZE5uP0dF8rwNpVYPIPbUtH0ICSQ5n6bWrczj7x4w6EzedI/37mEMHZHJzX8Y7fiQeg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dc/4.2.7/dc.js"
        integrity="sha512-ULRjYchIGoNAXgktDOljo9I6068lh36z4K2a8fDMQLp5xHHxGpvCdLr7TPbYYxDlT2ik585NeCO9xDIFS9SiEg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin-2.min.js"></script>

    <!-- Page level plugins -->
    <script src="vendor/chart.js/Chart.min.js"></script>

    <!-- Page level custom scripts -->
    <script src="js/demo/chart-area-demo.js"></script>
    <script src="js/demo/chart-pie-demo.js"></script>
    <script src="https://www.papaparse.com/resources/js/papaparse.js"></script>
    <script>
        document.getElementById('csvFile').addEventListener('change', handleFileSelect, false);

        function processData(csvData) {
            // var data = d3.csvParse(csvData);
            const dataset = d3.csvParse(csvData, (d) => {
                let parseDate = d3.utcParse("%Y-%m-%d %H:%M:%S")
                return {
                    Data: parseDate(d.Data.substr(0, 19)),
                    pH: +d.pH,
                    SST: +d.SST,
                    CT: +d.CT,
                    EColi: +d.EColi,
                    DQO: +d.DQO,
                    DQOf: +d.DQOf,
                    level: +d.level,
                    geral_pc1: +d.geral_pc1,
                    geral_pc2: +d.geral_pc2,
                    geral_pc3: +d.geral_pc3,
                    ETE: d.ETE,
                    Meta: d.Meta,
                    Unidade: d.Unidade,
                    Tipo: d.Tipo,
                    tsne1: +d.tsne1,
                    tsne2: +d.tsne2
                };
            });

            facts = crossfilter(dataset)

            eteDimension = facts.dimension(d => d.ETE)
            eteSumGroup = eteDimension.group().reduceCount(d => d.ETE)
            let eteAmountChart = dc.rowChart('#ete-sum');

            eteAmountChart
                .width(500)
                .height(2000)
                .x(d3.scaleBand())
                .elasticX(true)
                .dimension(eteDimension)
                .group(eteSumGroup)

            eteAmountChart.render()

            meta = facts.dimension(d => d.Meta);
            metaGroup = meta.group()

            let metasChart = dc.pieChart('#meta-chart');
            let all = facts.groupAll()

            metasChart
                .width(250)
                .height(250)
                .radius(100)
                .dimension(meta)
                .group(metaGroup)
                .label(d => {
                    if (metasChart.hasFilter() && !metasChart.hasFilter(d.key)) {
                        return `${d.key}(0%)`;
                    }
                    let label = d.key;
                    if (all.value()) {
                        label += `(${Math.floor(d.value / all.value() * 100)}%)`;
                    }
                    return label;
                })
                .renderLabel(true)
                .innerRadius(40)
                .transitionDuration(500)

            metasChart.render()

            let colorScale = d3.scaleOrdinal()
                .domain([0, 1, 2, 3, 4, 5])
                .range(['#003f5c', '#444e86', '#955196', '#dd5182', '#ff6e54', '#ffa600']);

            pc12Dim = facts.dimension(function (d) {
                return [+d.geral_pc1, +d.geral_pc2, +d.level];
            })

            pc12DimGroup = pc12Dim.group()

            let pca12chart = dc.scatterPlot('#pca-12')
            pca12chart.width(600)
                .height(600)
                .x(d3.scaleLinear().domain([-2, 10]))
                .y(d3.scaleLinear().domain([-10, 7]))
                .yAxisLabel("PC2")
                .xAxisLabel("PC1")
                .clipPadding(10)
                .dimension(pc12Dim)
                .group(pc12DimGroup)
                .excludedColor('#ddd')
                .colors(colorScale) // Set the color scale
                .colorAccessor(function (d) {
                    return d.key[2] // Assuming 'level' is the third value in the key array
                });

            pca12chart.render();

            tsne12Dim = facts.dimension(function (d) {
                return [+d.tsne1, +d.tsne2, +d.level];
            })

            tsne12DimGroup = tsne12Dim.group()

            let tsne12chart = dc.scatterPlot('#tsne-12')
            tsne12chart.width(600)
                .height(600)
                .x(d3.scaleLinear().domain([-5, 4]))
                .y(d3.scaleLinear().domain([-8, 7]))
                .yAxisLabel("tsne2")
                .xAxisLabel("tsne1")
                .clipPadding(10)
                .dimension(tsne12Dim)
                .group(tsne12DimGroup)
                .excludedColor('#ddd')
                .colors(colorScale) // Set the color scale
                .colorAccessor(function (d) {
                    return d.key[2] // Assuming 'level' is the third value in the key array
                });

            tsne12chart.render();

            tipoDim = facts.dimension(d => d.Tipo)
            tipoGroup = tipoDim.group()
            tipoSumGroup = tipoDim.group().reduceCount(d => d.Tipo)

            let tipoAmountChart = dc.barChart('#tipo-sum')
            let tipoNames = tipoDim.group().top(Infinity).map(d => d.key)

            tipoAmountChart
                .width(500)
                .height(300)
                .dimension(tipoDim)
                .group(tipoSumGroup)
                .x(d3.scaleBand())
                .xUnits(dc.units.ordinal)
                .gap(1)
                .elasticY(true)
                .barPadding(0.1)
                .outerPadding(0.05)
                .brushOn(true)

            tipoAmountChart.render()

            let dqoHistChart = dc.barChart("#dqo-hist")
            let dqoHistXScale = d3.scaleLinear().domain([0, 3200])
            let dqoHistYScale = d3.scaleLinear().domain([0, 20])

            dqo = facts.dimension(d => d.DQO)
            dqoGroup = dqo.group()

            dqoHistChart
                .width(1200)
                .height(100)
                .x(dqoHistXScale)
                .y(dqoHistYScale)
                .dimension(dqo)
                .group(dqoGroup)

            dqoHistChart.yAxis().ticks(4);
            dqoHistChart.render()

            dqoHistChart.on("filtered", function (chart) {
                // console.log(/* print the data filtered by the 'range selector' */);
                console.log({ testMean: eteDimension.top(Infinity) })
                let currentData = eteDimension.top(Infinity)
                const unique = [...new Set(currentData.map(item => item.ETE))]; // [ 'A', 'B']
                console.log({ unique }) // quantidade de etes que vem dos dados!!
            });


            let sstHistChart = dc.barChart("#sst-hist")
            let sstHistXScale = d3.scaleLinear().domain([0, 2700])
            let sstHistYScale = d3.scaleLinear().domain([0, 20])

            sstDim = facts.dimension(d => d.SST)
            sstGroup = sstDim.group()

            sstHistChart
                .width(1200)
                .height(100)
                .x(sstHistXScale)
                .y(sstHistYScale)
                .dimension(sstDim)
                .group(sstGroup)

            sstHistChart.yAxis().ticks(4);
            sstHistChart.render()

            let ecoliHistChart = dc.barChart("#ecoli-hist")
            let ecoliHistXScale = d3.scaleLinear().domain([0, 2700])
            let ecoliHistYScale = d3.scaleLinear().domain([0, 20])

            ecoliDim = facts.dimension(d => d.EColi)
            ecoliGroup = ecoliDim.group()

            ecoliHistChart
                .width(1200)
                .height(100)
                .x(ecoliHistXScale)
                .dimension(ecoliDim)
                .group(ecoliGroup)

            ecoliHistChart.yAxis().ticks(4);
            ecoliHistChart.render()


            let phHistChart = dc.barChart("#ph-hist")
            let phHistXScale = d3.scaleLinear().domain([0, 14])
            let phHistYScale = d3.scaleLinear().domain([0, 20])

            phDim = facts.dimension(d => d.pH)
            phGroup = phDim.group()

            phHistChart
                .width(1200)
                .height(100)
                .x(phHistXScale)
                .dimension(phDim)
                .group(phGroup)

            phHistChart.yAxis().ticks(4);
            phHistChart.render()

            dateDimension = facts.dimension(d => d.Data)
            let dataTable = dc.dataTable("#dc-table-graph")
            dataTable
                .width(900)
                .height(800)
                .dimension(dateDimension)
                .group(d => "Observações")
                .size(10)
                .columns(['Data', 'ETE', 'Tipo', 'pH', 'DQO', 'DQOf', 'SST', 'CT', 'EColi'])
                .sortBy(d => d.Data)
                .order(d3.ascending)
            dataTable.render()

            console.log(dataset);
        }

        function handleFileSelect(event) {
            var file = event.target.files[0];
            var reader = new FileReader();

            reader.onload = function (e) {
                var csvData = e.target.result;
                processData(csvData);
            };

            reader.readAsText(file);
        }
    </script>
    <style>
        .dc-chart g.row text {
            font-size: 25px;
        }

        .dc-chart .pie-slice {
            font-size: 20px;
        }
    </style>
</body>

</html>